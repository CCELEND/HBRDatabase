(()=>{"use strict";const e={get:e=>chrome.storage.local.get(e),set:async t=>{if(t instanceof Function){let s=await e.get(null);chrome.storage.local.set(t(s))}else chrome.storage.local.set(t)}},t=e;const s=new class{constructor(e=!1){this.debug=e}async getOrCreateClientId(){let{clientId:e}=await chrome.storage.local.get("clientId");return e||(e=self.crypto.randomUUID(),await chrome.storage.local.set({clientId:e})),e}async getOrCreateSessionId(){let{sessionData:e}=await chrome.storage.session.get("sessionData");const t=Date.now();if(e&&e.timestamp){(t-e.timestamp)/6e4>30?e=null:(e.timestamp=t,await chrome.storage.session.set({sessionData:e}))}return e||(e={session_id:t.toString(),timestamp:t.toString()},await chrome.storage.session.set({sessionData:e})),e.session_id}async fireEvent(e,t={}){try{const s=await fetch((this.debug?"https://www.google-analytics.com/debug/mp/collect":"https://www.google-analytics.com/mp/collect")+"?measurement_id=G-JRR08DY2S2&api_secret=in0CTbzSSQS6HG2q50xJOQ",{method:"POST",body:JSON.stringify({client_id:await this.getOrCreateClientId(),events:[{name:e,params:t}]})});if(!this.debug)return;console.log(await s.text())}catch(e){console.error("Google Analytics request failed with an exception",e)}}async firePageViewEvent(e,t,s={}){return this.fireEvent("page_view",{page_title:e,page_location:t,...s})}async fireErrorEvent(e,t={}){return this.fireEvent("extension_error",{...e,...t})}},a={statuses:{},skillLvs:{},growthAbilities:{},teamConfigs:new Array(10).fill({}),currentTeam:0};chrome.runtime.onInstalled.addListener((e=>{t.get(null).then((e=>{t.set({...a,...e})})),"install"===e.reason&&s.fireEvent("install",{version:`v${chrome.runtime.getManifest().version}`})})),chrome.action.onClicked.addListener((()=>{n()}));const n=async()=>{const e=await(async()=>await new Promise((e=>{chrome.runtime.sendMessage("Are you separate window?",(t=>{chrome.runtime.lastError&&e(null),e(t)}))})))();if(e){const{windowId:t}=e;chrome.windows.update(t,{focused:!0})}else{const e={url:chrome.runtime.getURL("/separate.html"),type:"popup",width:600,height:940,left:550,top:250};chrome.windows.create(e)}};chrome.runtime.onMessage.addListener((e=>{const{type:s,payload:a}=e;if("update_current_team_config"===s){const{teamConfig:e}=a;t.set((({currentTeam:t,teamConfigs:s})=>(s[t]=e,{teamConfigs:s})))}}))})();